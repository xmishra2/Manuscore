<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Manuscore ‚Äì Paper Evaluation Tool</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>üìù Manuscore</h1>
    <p>Multiframework Research Paper Evaluation</p>
  </header>

  <!-- Logout Button -->
  <button id="logoutBtn" onclick="logout()" style="display:none;">Logout</button>

  <!-- Login -->
  <section id="loginSection">
    <h2>Login</h2>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Username" required /><br><br>
      <input type="password" id="password" placeholder="Password" required autocomplete="current-password" /><br><br>
      <button type="submit">Login</button>
    </form>
  </section>

  <!-- Navigation -->
  <nav id="mainNav" style="display:none;">
    <button onclick="switchTab('home')" class="active">Home</button>
    <button onclick="switchTab('evaluation')">Evaluation</button>
    <button onclick="switchTab('records')">Records</button>
    <button onclick="switchTab('export')">Export</button>
  </nav>

  <!-- Tabs -->
  <section id="home" class="tab-content active">
    <h2>Welcome to Manuscore</h2>
    <p>This tool helps evaluate academic manuscripts across 15 research frameworks.</p>
  </section>

  <section id="evaluation" class="tab-content">
    <h2>Evaluate a Paper</h2>
    <form id="evaluationForm">
      <label>Paper Title:</label><br>
      <input type="text" id="paperTitle" required /><br>

      <label>DOI or Link:</label><br>
      <input type="text" id="paperDOI" /><br>

      <label>Notes:</label><br>
      <textarea id="evaluatorNotes" rows="4" cols="50"></textarea><br>

      <label>Evaluation Mode:</label><br>
      <select id="evalMode" required onchange="toggleDocType(this.value)">
        <option value="">-- Select Mode --</option>
        <option value="auto">Auto (based on manuscript type)</option>
        <option value="full">Comprehensive (all frameworks)</option>
      </select><br><br>

      <div id="docTypeSection" style="display:none;">
        <label>Document Type:</label><br>
        <select id="manuscriptType">
          <option value="">-- Select Document Type --</option>
          <option value="Article">Article</option>
          <option value="Review">Review</option>
          <option value="Case Report">Case Report</option>
          <option value="Conference Paper">Conference Paper</option>
          <option value="Editorial Material">Editorial Material</option>
          <option value="Letter">Letter</option>
          <option value="Short Survey">Short Survey</option>
          <option value="Data Paper">Data Paper</option>
          <option value="Book Review">Book Review</option>
          <option value="Software Review">Software Review</option>
          <option value="Guideline">Guideline</option>
          <option value="Qualitative Study">Qualitative Study</option>
          <option value="Meeting Abstract">Meeting Abstract</option>
        </select><br><br>
      </div>

      <div id="questionContainer"></div>
      <button type="submit">Save Evaluation</button>
    </form>
  </section>

  <section id="records" class="tab-content">
    <h2>Saved Records</h2>
    <ul id="recordList"></ul>
  </section>

  <section id="export" class="tab-content">
    <h2>Export</h2>
    <button onclick="downloadAllCSV()">Download CSV</button>
  </section>

  <!-- Behavior -->
  <script>
    const USERS = { evaluator: "manuscore", admin: "1234" };

    document.getElementById("loginForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const u = document.getElementById("username").value.trim();
      const p = document.getElementById("password").value.trim();
      if (USERS[u] === p) {
        localStorage.setItem("manuscoreUser", u);
        document.getElementById("loginSection").style.display = "none";
        document.getElementById("mainNav").style.display = "flex";
        document.getElementById("logoutBtn").style.display = "inline-block";
        document.getElementById("home").classList.add("active");
      } else {
        alert("Invalid login.");
      }
    });

    function logout() {
      localStorage.removeItem("manuscoreUser");
      location.reload();
    }

    function switchTab(id) {
      document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".tab-content").forEach(sec => sec.classList.remove("active"));
      document.querySelector("nav button[onclick*='" + id + "']").classList.add("active");
      document.getElementById(id).classList.add("active");
    }

    function toggleDocType(mode) {
      document.getElementById("docTypeSection").style.display = mode === "auto" ? "block" : "none";
    }
  </script>

  <!-- External JS -->
  <script src="questions.js"></script>
  <script src="app.js"></script>
</body>
</html>
